using System;

namespace At.Matus.BevMetrology
{
    public static class BevCie
    {
        private const int lowerIntegrationLimit = 360;
        private const int upperIntegrationLimit = 830;

        /// <summary>
        /// Spectral radiance of a black body
        /// </summary>
        /// <param name="T">Thermodynamic temperature in K</param>
        /// <param name="wavelength">Wavelength in air, in nm</param>
        /// <returns>Spectral radiance in W.m^-2.nm^-1.sr^-1</returns>
        /// <remarks>Reference: PTB Mitteilungen 107 6/97, p.397</remarks>
        /// <remarks>Lichtgeschwindigkeit:     c  = 299792458 m/s  </remarks>
        /// <remarks>Brechzahl fuer Normalluft n  = 1.00028</remarks>
        /// <remarks>1.Strahlungskonstante     c1 = 3.7417749e-16 W.s^2</remarks>
        /// <remarks>2.Strahlungskonstante     c2 = 1.438769e-2 m.K</remarks>
        public static double LPlanck(double T, double wavelength)
        {
            const double a = 1.19037602e20;
            const double b = 1.4383725e7;
            double L = a / (wavelength * wavelength * wavelength * wavelength * wavelength * (Math.Exp(b / (wavelength * T)) - 1.0));
            return L;
        }
        public static double LPlanck(double T, int wavelength) => LPlanck(T, (double)wavelength);

        /// <summary>
        /// CIE Illuminant A 
        /// ÖNORM EN ISO/CIE 11664-2:2023
        /// entspricht T = 2855.496 K
        /// </summary>
        /// <param name="wavelength">Wavelength in air, in nm</param>
        /// <returns>Value for given wavelength</returns>
        /// <remarks>Reference: CIE Standard Illuminants for Colorimetry</remarks>
        public static double CieIlluminantA(double wavelength)
        {
            double nwn = 560.0 / wavelength;
            double nwn5 = nwn * nwn * nwn * nwn * nwn;
            //return sA * Math.Exp((1435000.0 / 159488.0) - 1.0) / Math.Exp((14350000.0 / (2848.0 * wavelength)) - 1.0);
            return nwn5 * 297364.019099846 / Math.Exp((14350000.0 / (2848.0 * wavelength)) - 1.0);
        }
        public static double CieIlluminantA(int wavelength) => CieIlluminantA((double)wavelength);

        /// <summary>
        /// Spectral luminous efficiency for photopic vision
        /// </summary>
        /// <param name="wavelength">Wavelength in air, in nm</param>
        /// <returns>Value for given wavelength</returns>
        /// <remarks>Reference: Rapport BIPM-2019/05</remarks>
        public static double CieV(int wavelength) => ConvertArrayToFunction(wavelength, cieV, 360);

        /// <summary>
        /// Spectral luminous efficiency for scotopic vision
        /// </summary>
        /// <param name="wavelength">Wavelength in air, in nm</param>
        /// <returns>Value for given wavelength</returns>
        /// <remarks>Reference: Rapport BIPM-2019/05</remarks>
        public static double CieVs(int wavelength) => ConvertArrayToFunction(wavelength, cieVs, 380);

        /// <summary>
        /// CIE 1931 colour-matching function, x_bar
        /// </summary>
        /// <param name="wavelength">Wavelength in air, in nm</param>
        /// <returns>Value for given wavelength</returns>
        /// <remarks>Reference: Rapport BIPM-2019/05</remarks>
        public static double CieX2(int wavelength) => ConvertArrayToFunction(wavelength, cieX2, 360);

        /// <summary>
        /// CIE 1931 colour-matching function, y_bar
        /// </summary>
        /// <param name="wavelength">Wavelength in air, in nm</param>
        /// <returns>Value for given wavelength</returns>
        /// <remarks>Reference: Rapport BIPM-2019/05</remarks>
        public static double CieY2(int wavelength) => CieV(wavelength);

        /// <summary>
        /// CIE 1931 colour-matching function, z_bar
        /// </summary>
        /// <param name="wavelength">Wavelength in air, in nm</param>
        /// <returns>Value for given wavelength</returns>
        /// <remarks>Reference: Rapport BIPM-2019/05</remarks>
        public static double CieZ2(int wavelength) => ConvertArrayToFunction(wavelength, cieZ2, 360);

        /// <summary>
        /// Spectral mismatch correction factor relativ to CIE Illuminant A.
        /// </summary>
        /// <param name="specResponse">Relative spectral responsivity of photometer.</param>
        /// <param name="specPower">Spectral power distribution of test source.</param>
        /// <returns></returns>
        public static double CcfStar(Func<int, double> specResponse, Func<int, double> specPower)
        {
            double a = Integrate(CieIlluminantA, specResponse);
            double b = Integrate(specPower, CieV);
            double c = Integrate(CieIlluminantA, CieV); // this is a constant!
            double d = Integrate(specPower, specResponse);
            return a * b / (c * d);
        }

        /// <summary>
        /// Spectral mismatch correction factor relativ to CIE Illuminant A.
        /// </summary>
        /// <param name="specResponse">Relative spectral responsivity of photometer.</param>
        /// <param name="temperature">Distribution temperature of test source.</param>
        /// <returns></returns>
        public static double CcfStar(Func<int, double> specResponse, double temperature)
        {
            double plank(int i) => LPlanck(temperature, i);
            return CcfStar(specResponse, plank);
        }

        public static double Integrate(Func<int, double> spec, Func<int, double> weight)
        {
            double weightedSpec(int i) => spec(i) * weight(i);
            return Integrate(weightedSpec);
        }

        public static double Integrate(Func<int, double> spec)
        {
            double integral = 0.0;
            for (int i = lowerIntegrationLimit; i <= upperIntegrationLimit; i++)
            {
                integral += spec(i);
            }
            return integral;
        }

        #region private stuff

        // TODO implement D65, D50, cieX10, cieY10, cieZ10

        private static readonly double[] cieV = new double[]
        {
            3.917000e-6 ,
            4.393581e-6 ,
            4.929604e-6 ,
            5.532136e-6 ,
            6.208245e-6 ,
            6.965000e-6 ,
            7.813219e-6 ,
            8.767336e-6 ,
            9.839844e-6 ,
            1.104323e-5 ,
            1.239000e-5 ,
            1.388641e-5 ,
            1.555728e-5 ,
            1.744296e-5 ,
            1.958375e-5 ,
            2.202000e-5 ,
            2.483965e-5 ,
            2.804126e-5 ,
            3.153104e-5 ,
            3.521521e-5 ,
            3.900000e-5 ,
            4.282640e-5 ,
            4.691460e-5 ,
            5.158960e-5 ,
            5.717640e-5 ,
            6.400000e-5 ,
            7.234421e-5 ,
            8.221224e-5 ,
            9.350816e-5 ,
            1.061361e-4 ,
            1.200000e-4 ,
            1.349840e-4 ,
            1.514920e-4 ,
            1.702080e-4 ,
            1.918160e-4 ,
            2.170000e-4 ,
            2.469067e-4 ,
            2.812400e-4 ,
            3.185200e-4 ,
            3.572667e-4 ,
            3.960000e-4 ,
            4.337147e-4 ,
            4.730240e-4 ,
            5.178760e-4 ,
            5.722187e-4 ,
            6.400000e-4 ,
            7.245600e-4 ,
            8.255000e-4 ,
            9.411600e-4 ,
            1.069880e-3 ,
            1.210000e-3 ,
            1.362091e-3 ,
            1.530752e-3 ,
            1.720368e-3 ,
            1.935323e-3 ,
            2.180000e-3 ,
            2.454800e-3 ,
            2.764000e-3 ,
            3.117800e-3 ,
            3.526400e-3 ,
            4.000000e-3 ,
            4.546240e-3 ,
            5.159320e-3 ,
            5.829280e-3 ,
            6.546160e-3 ,
            7.300000e-3 ,
            8.086507e-3 ,
            8.908720e-3 ,
            9.767680e-3 ,
            1.066443e-2 ,
            1.160000e-2 ,
            1.257317e-2 ,
            1.358272e-2 ,
            1.462968e-2 ,
            1.571509e-2 ,
            1.684000e-2 ,
            1.800736e-2 ,
            1.921448e-2 ,
            2.045392e-2 ,
            2.171824e-2 ,
            2.300000e-2 ,
            2.429461e-2 ,
            2.561024e-2 ,
            2.695857e-2 ,
            2.835125e-2 ,
            2.980000e-2 ,
            3.131083e-2 ,
            3.288368e-2 ,
            3.452112e-2 ,
            3.622571e-2 ,
            3.800000e-2 ,
            3.984667e-2 ,
            4.176800e-2 ,
            4.376600e-2 ,
            4.584267e-2 ,
            4.800000e-2 ,
            5.024368e-2 ,
            5.257304e-2 ,
            5.498056e-2 ,
            5.745872e-2 ,
            6.000000e-2 ,
            6.260197e-2 ,
            6.527752e-2 ,
            6.804208e-2 ,
            7.091109e-2 ,
            7.390000e-2 ,
            7.701600e-2 ,
            8.026640e-2 ,
            8.366680e-2 ,
            8.723280e-2 ,
            9.098000e-2 ,
            9.491755e-2 ,
            9.904584e-2 ,
            1.033674e-1 ,
            1.078846e-1 ,
            1.126000e-1 ,
            1.175320e-1 ,
            1.226744e-1 ,
            1.279928e-1 ,
            1.334528e-1 ,
            1.390200e-1 ,
            1.446764e-1 ,
            1.504693e-1 ,
            1.564619e-1 ,
            1.627177e-1 ,
            1.693000e-1 ,
            1.762431e-1 ,
            1.835581e-1 ,
            1.912735e-1 ,
            1.994180e-1 ,
            2.080200e-1 ,
            2.171199e-1 ,
            2.267345e-1 ,
            2.368571e-1 ,
            2.474812e-1 ,
            2.586000e-1 ,
            2.701849e-1 ,
            2.822939e-1 ,
            2.950505e-1 ,
            3.085780e-1 ,
            3.230000e-1 ,
            3.384021e-1 ,
            3.546858e-1 ,
            3.716986e-1 ,
            3.892875e-1 ,
            4.073000e-1 ,
            4.256299e-1 ,
            4.443096e-1 ,
            4.633944e-1 ,
            4.829395e-1 ,
            5.030000e-1 ,
            5.235693e-1 ,
            5.445120e-1 ,
            5.656900e-1 ,
            5.869653e-1 ,
            6.082000e-1 ,
            6.293456e-1 ,
            6.503068e-1 ,
            6.708752e-1 ,
            6.908424e-1 ,
            7.100000e-1 ,
            7.281852e-1 ,
            7.454636e-1 ,
            7.619694e-1 ,
            7.778368e-1 ,
            7.932000e-1 ,
            8.081104e-1 ,
            8.224962e-1 ,
            8.363068e-1 ,
            8.494916e-1 ,
            8.620000e-1 ,
            8.738108e-1 ,
            8.849624e-1 ,
            8.954936e-1 ,
            9.054432e-1 ,
            9.148501e-1 ,
            9.237348e-1 ,
            9.320924e-1 ,
            9.399226e-1 ,
            9.472252e-1 ,
            9.540000e-1 ,
            9.602561e-1 ,
            9.660074e-1 ,
            9.712606e-1 ,
            9.760225e-1 ,
            9.803000e-1 ,
            9.840924e-1 ,
            9.874182e-1 ,
            9.903128e-1 ,
            9.928116e-1 ,
            9.949501e-1 ,
            9.967108e-1 ,
            9.980983e-1 ,
            9.991120e-1 ,
            9.997482e-1 ,
            1.000000e+0 ,
            9.998567e-1 ,
            9.993046e-1 ,
            9.983255e-1 ,
            9.968987e-1 ,
            9.950000e-1 ,
            9.926005e-1 ,
            9.897426e-1 ,
            9.864444e-1 ,
            9.827241e-1 ,
            9.786000e-1 ,
            9.740837e-1 ,
            9.691712e-1 ,
            9.638568e-1 ,
            9.581349e-1 ,
            9.520000e-1 ,
            9.454504e-1 ,
            9.384992e-1 ,
            9.311628e-1 ,
            9.234576e-1 ,
            9.154000e-1 ,
            9.070064e-1 ,
            8.982772e-1 ,
            8.892048e-1 ,
            8.797816e-1 ,
            8.700000e-1 ,
            8.598613e-1 ,
            8.493920e-1 ,
            8.386220e-1 ,
            8.275813e-1 ,
            8.163000e-1 ,
            8.047947e-1 ,
            7.930820e-1 ,
            7.811920e-1 ,
            7.691547e-1 ,
            7.570000e-1 ,
            7.447541e-1 ,
            7.324224e-1 ,
            7.200036e-1 ,
            7.074965e-1 ,
            6.949000e-1 ,
            6.822192e-1 ,
            6.694716e-1 ,
            6.566744e-1 ,
            6.438448e-1 ,
            6.310000e-1 ,
            6.181555e-1 ,
            6.053144e-1 ,
            5.924756e-1 ,
            5.796379e-1 ,
            5.668000e-1 ,
            5.539611e-1 ,
            5.411372e-1 ,
            5.283528e-1 ,
            5.156323e-1 ,
            5.030000e-1 ,
            4.904688e-1 ,
            4.780304e-1 ,
            4.656776e-1 ,
            4.534032e-1 ,
            4.412000e-1 ,
            4.290800e-1 ,
            4.170360e-1 ,
            4.050320e-1 ,
            3.930320e-1 ,
            3.810000e-1 ,
            3.689184e-1 ,
            3.568272e-1 ,
            3.447768e-1 ,
            3.328176e-1 ,
            3.210000e-1 ,
            3.093381e-1 ,
            2.978504e-1 ,
            2.865936e-1 ,
            2.756245e-1 ,
            2.650000e-1 ,
            2.547632e-1 ,
            2.448896e-1 ,
            2.353344e-1 ,
            2.260528e-1 ,
            2.170000e-1 ,
            2.081616e-1 ,
            1.995488e-1 ,
            1.911552e-1 ,
            1.829744e-1 ,
            1.750000e-1 ,
            1.672235e-1 ,
            1.596464e-1 ,
            1.522776e-1 ,
            1.451259e-1 ,
            1.382000e-1 ,
            1.315003e-1 ,
            1.250248e-1 ,
            1.187792e-1 ,
            1.127691e-1 ,
            1.070000e-1 ,
            1.014762e-1 ,
            9.618864e-2 ,
            9.112296e-2 ,
            8.626485e-2 ,
            8.160000e-2 ,
            7.712064e-2 ,
            7.282552e-2 ,
            6.871008e-2 ,
            6.476976e-2 ,
            6.100000e-2 ,
            5.739621e-2 ,
            5.395504e-2 ,
            5.067376e-2 ,
            4.754965e-2 ,
            4.458000e-2 ,
            4.175872e-2 ,
            3.908496e-2 ,
            3.656384e-2 ,
            3.420048e-2 ,
            3.200000e-2 ,
            2.996261e-2 ,
            2.807664e-2 ,
            2.632936e-2 ,
            2.470805e-2 ,
            2.320000e-2 ,
            2.180077e-2 ,
            2.050112e-2 ,
            1.928108e-2 ,
            1.812069e-2 ,
            1.700000e-2 ,
            1.590379e-2 ,
            1.483718e-2 ,
            1.381068e-2 ,
            1.283478e-2 ,
            1.192000e-2 ,
            1.106831e-2 ,
            1.027339e-2 ,
            9.533311e-3 ,
            8.846157e-3 ,
            8.210000e-3 ,
            7.623781e-3 ,
            7.085424e-3 ,
            6.591476e-3 ,
            6.138485e-3 ,
            5.723000e-3 ,
            5.343059e-3 ,
            4.995796e-3 ,
            4.676404e-3 ,
            4.380075e-3 ,
            4.102000e-3 ,
            3.838453e-3 ,
            3.589099e-3 ,
            3.354219e-3 ,
            3.134093e-3 ,
            2.929000e-3 ,
            2.738139e-3 ,
            2.559876e-3 ,
            2.393244e-3 ,
            2.237275e-3 ,
            2.091000e-3 ,
            1.953587e-3 ,
            1.824580e-3 ,
            1.703580e-3 ,
            1.590187e-3 ,
            1.484000e-3 ,
            1.384496e-3 ,
            1.291268e-3 ,
            1.204092e-3 ,
            1.122744e-3 ,
            1.047000e-3 ,
            9.765896e-4 ,
            9.111088e-4 ,
            8.501332e-4 ,
            7.932384e-4 ,
            7.400000e-4 ,
            6.900827e-4 ,
            6.433100e-4 ,
            5.994960e-4 ,
            5.584547e-4 ,
            5.200000e-4 ,
            4.839136e-4 ,
            4.500528e-4 ,
            4.183452e-4 ,
            3.887184e-4 ,
            3.611000e-4 ,
            3.353835e-4 ,
            3.114404e-4 ,
            2.891656e-4 ,
            2.684539e-4 ,
            2.492000e-4 ,
            2.313019e-4 ,
            2.146856e-4 ,
            1.992884e-4 ,
            1.850475e-4 ,
            1.719000e-4 ,
            1.597781e-4 ,
            1.486044e-4 ,
            1.383016e-4 ,
            1.287925e-4 ,
            1.200000e-4 ,
            1.118595e-4 ,
            1.043224e-4 ,
            9.733560e-5 ,
            9.084587e-5 ,
            8.480000e-5 ,
            7.914667e-5 ,
            7.385800e-5 ,
            6.891600e-5 ,
            6.430267e-5 ,
            6.000000e-5 ,
            5.598187e-5 ,
            5.222560e-5 ,
            4.871840e-5 ,
            4.544747e-5 ,
            4.240000e-5 ,
            3.956104e-5 ,
            3.691512e-5 ,
            3.444868e-5 ,
            3.214816e-5 ,
            3.000000e-5 ,
            2.799125e-5 ,
            2.611356e-5 ,
            2.436024e-5 ,
            2.272461e-5 ,
            2.120000e-5 ,
            1.977855e-5 ,
            1.845285e-5 ,
            1.721687e-5 ,
            1.606459e-5 ,
            1.499000e-5 ,
            1.398728e-5 ,
            1.305155e-5 ,
            1.217818e-5 ,
            1.136254e-5 ,
            1.060000e-5 ,
            9.885877e-6 ,
            9.217304e-6 ,
            8.592362e-6 ,
            8.009133e-6 ,
            7.465700e-6 ,
            6.959567e-6 ,
            6.487995e-6 ,
            6.048699e-6 ,
            5.639396e-6 ,
            5.257800e-6 ,
            4.901771e-6 ,
            4.569720e-6 ,
            4.260194e-6 ,
            3.971739e-6 ,
            3.702900e-6 ,
            3.452163e-6 ,
            3.218302e-6 ,
            3.000300e-6 ,
            2.797139e-6 ,
            2.607800e-6 ,
            2.431220e-6 ,
            2.266531e-6 ,
            2.113013e-6 ,
            1.969943e-6 ,
            1.836600e-6 ,
            1.712230e-6 ,
            1.596228e-6 ,
            1.488090e-6 ,
            1.387314e-6 ,
            1.293400e-6 ,
            1.205820e-6 ,
            1.124143e-6 ,
            1.048009e-6 ,
            9.770578e-7 ,
            9.109300e-7 ,
            8.492513e-7 ,
            7.917212e-7 ,
            7.380904e-7 ,
            6.881098e-7 ,
            6.415300e-7 ,
            5.980895e-7 ,
            5.575746e-7 ,
            5.198080e-7 ,
            4.846123e-7 ,
            4.518100e-7
        };

        private static readonly double[] cieX2 = new double[]
        {
            1.299000e-4 ,
            1.458470e-4 ,
            1.638021e-4 ,
            1.840037e-4 ,
            2.066902e-4 ,
            2.321000e-4 ,
            2.607280e-4 ,
            2.930750e-4 ,
            3.293880e-4 ,
            3.699140e-4 ,
            4.149000e-4 ,
            4.641587e-4 ,
            5.189860e-4 ,
            5.818540e-4 ,
            6.552347e-4 ,
            7.416000e-4 ,
            8.450296e-4 ,
            9.645268e-4 ,
            1.094949e-3 ,
            1.231154e-3 ,
            1.368000e-3 ,
            1.502050e-3 ,
            1.642328e-3 ,
            1.802382e-3 ,
            1.995757e-3 ,
            2.236000e-3 ,
            2.535385e-3 ,
            2.892603e-3 ,
            3.300829e-3 ,
            3.753236e-3 ,
            4.243000e-3 ,
            4.762389e-3 ,
            5.330048e-3 ,
            5.978712e-3 ,
            6.741117e-3 ,
            7.650000e-3 ,
            8.751373e-3 ,
            1.002888e-2 ,
            1.142170e-2 ,
            1.286901e-2 ,
            1.431000e-2 ,
            1.570443e-2 ,
            1.714744e-2 ,
            1.878122e-2 ,
            2.074801e-2 ,
            2.319000e-2 ,
            2.620736e-2 ,
            2.978248e-2 ,
            3.388092e-2 ,
            3.846824e-2 ,
            4.351000e-2 ,
            4.899560e-2 ,
            5.502260e-2 ,
            6.171880e-2 ,
            6.921200e-2 ,
            7.763000e-2 ,
            8.695811e-2 ,
            9.717672e-2 ,
            1.084063e-1 ,
            1.207672e-1 ,
            1.343800e-1 ,
            1.493582e-1 ,
            1.653957e-1 ,
            1.819831e-1 ,
            1.986110e-1 ,
            2.147700e-1 ,
            2.301868e-1 ,
            2.448797e-1 ,
            2.587773e-1 ,
            2.718079e-1 ,
            2.839000e-1 ,
            2.949438e-1 ,
            3.048965e-1 ,
            3.137873e-1 ,
            3.216454e-1 ,
            3.285000e-1 ,
            3.343513e-1 ,
            3.392101e-1 ,
            3.431213e-1 ,
            3.461296e-1 ,
            3.482800e-1 ,
            3.495999e-1 ,
            3.501474e-1 ,
            3.500130e-1 ,
            3.492870e-1 ,
            3.480600e-1 ,
            3.463733e-1 ,
            3.442624e-1 ,
            3.418088e-1 ,
            3.390941e-1 ,
            3.362000e-1 ,
            3.331977e-1 ,
            3.300411e-1 ,
            3.266357e-1 ,
            3.228868e-1 ,
            3.187000e-1 ,
            3.140251e-1 ,
            3.088840e-1 ,
            3.032904e-1 ,
            2.972579e-1 ,
            2.908000e-1 ,
            2.839701e-1 ,
            2.767214e-1 ,
            2.689178e-1 ,
            2.604227e-1 ,
            2.511000e-1 ,
            2.408475e-1 ,
            2.298512e-1 ,
            2.184072e-1 ,
            2.068115e-1 ,
            1.953600e-1 ,
            1.842136e-1 ,
            1.733273e-1 ,
            1.626881e-1 ,
            1.522833e-1 ,
            1.421000e-1 ,
            1.321786e-1 ,
            1.225696e-1 ,
            1.132752e-1 ,
            1.042979e-1 ,
            9.564000e-2 ,
            8.729955e-2 ,
            7.930804e-2 ,
            7.171776e-2 ,
            6.458099e-2 ,
            5.795001e-2 ,
            5.186211e-2 ,
            4.628152e-2 ,
            4.115088e-2 ,
            3.641283e-2 ,
            3.201000e-2 ,
            2.791720e-2 ,
            2.414440e-2 ,
            2.068700e-2 ,
            1.754040e-2 ,
            1.470000e-2 ,
            1.216179e-2 ,
            9.919960e-3 ,
            7.967240e-3 ,
            6.296346e-3 ,
            4.900000e-3 ,
            3.777173e-3 ,
            2.945320e-3 ,
            2.424880e-3 ,
            2.236293e-3 ,
            2.400000e-3 ,
            2.925520e-3 ,
            3.836560e-3 ,
            5.174840e-3 ,
            6.982080e-3 ,
            9.300000e-3 ,
            1.214949e-2 ,
            1.553588e-2 ,
            1.947752e-2 ,
            2.399277e-2 ,
            2.910000e-2 ,
            3.481485e-2 ,
            4.112016e-2 ,
            4.798504e-2 ,
            5.537861e-2 ,
            6.327000e-2 ,
            7.163501e-2 ,
            8.046224e-2 ,
            8.973996e-2 ,
            9.945645e-2 ,
            1.096000e-1 ,
            1.201674e-1 ,
            1.311145e-1 ,
            1.423679e-1 ,
            1.538542e-1 ,
            1.655000e-1 ,
            1.772571e-1 ,
            1.891400e-1 ,
            2.011694e-1 ,
            2.133658e-1 ,
            2.257499e-1 ,
            2.383209e-1 ,
            2.510668e-1 ,
            2.639922e-1 ,
            2.771017e-1 ,
            2.904000e-1 ,
            3.038912e-1 ,
            3.175726e-1 ,
            3.314384e-1 ,
            3.454828e-1 ,
            3.597000e-1 ,
            3.740839e-1 ,
            3.886396e-1 ,
            4.033784e-1 ,
            4.183115e-1 ,
            4.334499e-1 ,
            4.487953e-1 ,
            4.643360e-1 ,
            4.800640e-1 ,
            4.959713e-1 ,
            5.120501e-1 ,
            5.282959e-1 ,
            5.446916e-1 ,
            5.612094e-1 ,
            5.778215e-1 ,
            5.945000e-1 ,
            6.112209e-1 ,
            6.279758e-1 ,
            6.447602e-1 ,
            6.615697e-1 ,
            6.784000e-1 ,
            6.952392e-1 ,
            7.120586e-1 ,
            7.288284e-1 ,
            7.455188e-1 ,
            7.621000e-1 ,
            7.785432e-1 ,
            7.948256e-1 ,
            8.109264e-1 ,
            8.268248e-1 ,
            8.425000e-1 ,
            8.579325e-1 ,
            8.730816e-1 ,
            8.878944e-1 ,
            9.023181e-1 ,
            9.163000e-1 ,
            9.297995e-1 ,
            9.427984e-1 ,
            9.552776e-1 ,
            9.672179e-1 ,
            9.786000e-1 ,
            9.893856e-1 ,
            9.995488e-1 ,
            1.009089e+0 ,
            1.018006e+0 ,
            1.026300e+0 ,
            1.033983e+0 ,
            1.040986e+0 ,
            1.047188e+0 ,
            1.052467e+0 ,
            1.056700e+0 ,
            1.059794e+0 ,
            1.061799e+0 ,
            1.062807e+0 ,
            1.062910e+0 ,
            1.062200e+0 ,
            1.060735e+0 ,
            1.058444e+0 ,
            1.055224e+0 ,
            1.050977e+0 ,
            1.045600e+0 ,
            1.039037e+0 ,
            1.031361e+0 ,
            1.022666e+0 ,
            1.013048e+0 ,
            1.002600e+0 ,
            9.913675e-1 ,
            9.793314e-1 ,
            9.664916e-1 ,
            9.528479e-1 ,
            9.384000e-1 ,
            9.231940e-1 ,
            9.072440e-1 ,
            8.905020e-1 ,
            8.729200e-1 ,
            8.544499e-1 ,
            8.350840e-1 ,
            8.149460e-1 ,
            7.941860e-1 ,
            7.729540e-1 ,
            7.514000e-1 ,
            7.295836e-1 ,
            7.075888e-1 ,
            6.856022e-1 ,
            6.638104e-1 ,
            6.424000e-1 ,
            6.215149e-1 ,
            6.011138e-1 ,
            5.811052e-1 ,
            5.613977e-1 ,
            5.419000e-1 ,
            5.225995e-1 ,
            5.035464e-1 ,
            4.847436e-1 ,
            4.661939e-1 ,
            4.479000e-1 ,
            4.298613e-1 ,
            4.120980e-1 ,
            3.946440e-1 ,
            3.775333e-1 ,
            3.608000e-1 ,
            3.444563e-1 ,
            3.285168e-1 ,
            3.130192e-1 ,
            2.980011e-1 ,
            2.835000e-1 ,
            2.695448e-1 ,
            2.561184e-1 ,
            2.431896e-1 ,
            2.307272e-1 ,
            2.187000e-1 ,
            2.070971e-1 ,
            1.959232e-1 ,
            1.851708e-1 ,
            1.748323e-1 ,
            1.649000e-1 ,
            1.553667e-1 ,
            1.462300e-1 ,
            1.374900e-1 ,
            1.291467e-1 ,
            1.212000e-1 ,
            1.136397e-1 ,
            1.064650e-1 ,
            9.969044e-2 ,
            9.333061e-2 ,
            8.740000e-2 ,
            8.190096e-2 ,
            7.680428e-2 ,
            7.207712e-2 ,
            6.768664e-2 ,
            6.360000e-2 ,
            5.980685e-2 ,
            5.628216e-2 ,
            5.297104e-2 ,
            4.981861e-2 ,
            4.677000e-2 ,
            4.378405e-2 ,
            4.087536e-2 ,
            3.807264e-2 ,
            3.540461e-2 ,
            3.290000e-2 ,
            3.056419e-2 ,
            2.838056e-2 ,
            2.634484e-2 ,
            2.445275e-2 ,
            2.270000e-2 ,
            2.108429e-2 ,
            1.959988e-2 ,
            1.823732e-2 ,
            1.698717e-2 ,
            1.584000e-2 ,
            1.479064e-2 ,
            1.383132e-2 ,
            1.294868e-2 ,
            1.212920e-2 ,
            1.135916e-2 ,
            1.062935e-2 ,
            9.938846e-3 ,
            9.288422e-3 ,
            8.678854e-3 ,
            8.110916e-3 ,
            7.582388e-3 ,
            7.088746e-3 ,
            6.627313e-3 ,
            6.195408e-3 ,
            5.790346e-3 ,
            5.409826e-3 ,
            5.052583e-3 ,
            4.717512e-3 ,
            4.403507e-3 ,
            4.109457e-3 ,
            3.833913e-3 ,
            3.575748e-3 ,
            3.334342e-3 ,
            3.109075e-3 ,
            2.899327e-3 ,
            2.704348e-3 ,
            2.523020e-3 ,
            2.354168e-3 ,
            2.196616e-3 ,
            2.049190e-3 ,
            1.910960e-3 ,
            1.781438e-3 ,
            1.660110e-3 ,
            1.546459e-3 ,
            1.439971e-3 ,
            1.340042e-3 ,
            1.246275e-3 ,
            1.158471e-3 ,
            1.076430e-3 ,
            9.999493e-4 ,
            9.287358e-4 ,
            8.624332e-4 ,
            8.007503e-4 ,
            7.433960e-4 ,
            6.900786e-4 ,
            6.405156e-4 ,
            5.945021e-4 ,
            5.518646e-4 ,
            5.124290e-4 ,
            4.760213e-4 ,
            4.424536e-4 ,
            4.115117e-4 ,
            3.829814e-4 ,
            3.566491e-4 ,
            3.323011e-4 ,
            3.097586e-4 ,
            2.888871e-4 ,
            2.695394e-4 ,
            2.515682e-4 ,
            2.348261e-4 ,
            2.191710e-4 ,
            2.045258e-4 ,
            1.908405e-4 ,
            1.780654e-4 ,
            1.661505e-4 ,
            1.550236e-4 ,
            1.446219e-4 ,
            1.349098e-4 ,
            1.258520e-4 ,
            1.174130e-4 ,
            1.095515e-4 ,
            1.022245e-4 ,
            9.539445e-5 ,
            8.902390e-5 ,
            8.307527e-5 ,
            7.751269e-5 ,
            7.231304e-5 ,
            6.745778e-5 ,
            6.292844e-5 ,
            5.870652e-5 ,
            5.477028e-5 ,
            5.109918e-5 ,
            4.767654e-5 ,
            4.448567e-5 ,
            4.150994e-5 ,
            3.873324e-5 ,
            3.614203e-5 ,
            3.372352e-5 ,
            3.146487e-5 ,
            2.935326e-5 ,
            2.737573e-5 ,
            2.552433e-5 ,
            2.379376e-5 ,
            2.217870e-5 ,
            2.067383e-5 ,
            1.927226e-5 ,
            1.796640e-5 ,
            1.674991e-5 ,
            1.561648e-5 ,
            1.455977e-5 ,
            1.357387e-5 ,
            1.265436e-5 ,
            1.179723e-5 ,
            1.099844e-5 ,
            1.025398e-5 ,
            9.559646e-6 ,
            8.912044e-6 ,
            8.308358e-6 ,
            7.745769e-6 ,
            7.221456e-6 ,
            6.732475e-6 ,
            6.276423e-6 ,
            5.851304e-6 ,
            5.455118e-6 ,
            5.085868e-6 ,
            4.741466e-6 ,
            4.420236e-6 ,
            4.120783e-6 ,
            3.841716e-6 ,
            3.581652e-6 ,
            3.339127e-6 ,
            3.112949e-6 ,
            2.902121e-6 ,
            2.705645e-6 ,
            2.522525e-6 ,
            2.351726e-6 ,
            2.192415e-6 ,
            2.043902e-6 ,
            1.905497e-6 ,
            1.776509e-6 ,
            1.656215e-6 ,
            1.544022e-6 ,
            1.439440e-6 ,
            1.341977e-6 ,
            1.251141e-6
        };

        private static readonly double[] cieZ2 = new double[]
        {
            6.061000e-4 ,
            6.808792e-4 ,
            7.651456e-4 ,
            8.600124e-4 ,
            9.665928e-4 ,
            1.086000e-3 ,
            1.220586e-3 ,
            1.372729e-3 ,
            1.543579e-3 ,
            1.734286e-3 ,
            1.946000e-3 ,
            2.177777e-3 ,
            2.435809e-3 ,
            2.731953e-3 ,
            3.078064e-3 ,
            3.486000e-3 ,
            3.975227e-3 ,
            4.540880e-3 ,
            5.158320e-3 ,
            5.802907e-3 ,
            6.450001e-3 ,
            7.083216e-3 ,
            7.745488e-3 ,
            8.501152e-3 ,
            9.414544e-3 ,
            1.054999e-2 ,
            1.196580e-2 ,
            1.365587e-2 ,
            1.558805e-2 ,
            1.773015e-2 ,
            2.005001e-2 ,
            2.251136e-2 ,
            2.520288e-2 ,
            2.827972e-2 ,
            3.189704e-2 ,
            3.621000e-2 ,
            4.143771e-2 ,
            4.750372e-2 ,
            5.411988e-2 ,
            6.099803e-2 ,
            6.785001e-2 ,
            7.448632e-2 ,
            8.136156e-2 ,
            8.915364e-2 ,
            9.854048e-2 ,
            1.102000e-1 ,
            1.246133e-1 ,
            1.417017e-1 ,
            1.613035e-1 ,
            1.832568e-1 ,
            2.074000e-1 ,
            2.336921e-1 ,
            2.626114e-1 ,
            2.947746e-1 ,
            3.307985e-1 ,
            3.713000e-1 ,
            4.162091e-1 ,
            4.654642e-1 ,
            5.196948e-1 ,
            5.795303e-1 ,
            6.456000e-1 ,
            7.184838e-1 ,
            7.967133e-1 ,
            8.778459e-1 ,
            9.594390e-1 ,
            1.039050e+0 ,
            1.115367e+0 ,
            1.188497e+0 ,
            1.258123e+0 ,
            1.323930e+0 ,
            1.385600e+0 ,
            1.442635e+0 ,
            1.494804e+0 ,
            1.542190e+0 ,
            1.584881e+0 ,
            1.622960e+0 ,
            1.656405e+0 ,
            1.685296e+0 ,
            1.709875e+0 ,
            1.730382e+0 ,
            1.747060e+0 ,
            1.760045e+0 ,
            1.769623e+0 ,
            1.776264e+0 ,
            1.780433e+0 ,
            1.782600e+0 ,
            1.782968e+0 ,
            1.781700e+0 ,
            1.779198e+0 ,
            1.775867e+0 ,
            1.772110e+0 ,
            1.768259e+0 ,
            1.764039e+0 ,
            1.758944e+0 ,
            1.752466e+0 ,
            1.744100e+0 ,
            1.733560e+0 ,
            1.720858e+0 ,
            1.705937e+0 ,
            1.688737e+0 ,
            1.669200e+0 ,
            1.647529e+0 ,
            1.623413e+0 ,
            1.596022e+0 ,
            1.564528e+0 ,
            1.528100e+0 ,
            1.486111e+0 ,
            1.439522e+0 ,
            1.389880e+0 ,
            1.338736e+0 ,
            1.287640e+0 ,
            1.237422e+0 ,
            1.187824e+0 ,
            1.138761e+0 ,
            1.090148e+0 ,
            1.041900e+0 ,
            9.941976e-1 ,
            9.473473e-1 ,
            9.014531e-1 ,
            8.566193e-1 ,
            8.129501e-1 ,
            7.705173e-1 ,
            7.294448e-1 ,
            6.899136e-1 ,
            6.521049e-1 ,
            6.162000e-1 ,
            5.823286e-1 ,
            5.504162e-1 ,
            5.203376e-1 ,
            4.919673e-1 ,
            4.651800e-1 ,
            4.399246e-1 ,
            4.161836e-1 ,
            3.938822e-1 ,
            3.729459e-1 ,
            3.533000e-1 ,
            3.348578e-1 ,
            3.175521e-1 ,
            3.013375e-1 ,
            2.861686e-1 ,
            2.720000e-1 ,
            2.588171e-1 ,
            2.464838e-1 ,
            2.347718e-1 ,
            2.234533e-1 ,
            2.123000e-1 ,
            2.011692e-1 ,
            1.901196e-1 ,
            1.792254e-1 ,
            1.685608e-1 ,
            1.582000e-1 ,
            1.481383e-1 ,
            1.383758e-1 ,
            1.289942e-1 ,
            1.200751e-1 ,
            1.117000e-1 ,
            1.039048e-1 ,
            9.666748e-2 ,
            8.998272e-2 ,
            8.384531e-2 ,
            7.824999e-2 ,
            7.320899e-2 ,
            6.867816e-2 ,
            6.456784e-2 ,
            6.078835e-2 ,
            5.725001e-2 ,
            5.390435e-2 ,
            5.074664e-2 ,
            4.775276e-2 ,
            4.489859e-2 ,
            4.216000e-2 ,
            3.950728e-2 ,
            3.693564e-2 ,
            3.445836e-2 ,
            3.208872e-2 ,
            2.984000e-2 ,
            2.771181e-2 ,
            2.569444e-2 ,
            2.378716e-2 ,
            2.198925e-2 ,
            2.030000e-2 ,
            1.871805e-2 ,
            1.724036e-2 ,
            1.586364e-2 ,
            1.458461e-2 ,
            1.340000e-2 ,
            1.230723e-2 ,
            1.130188e-2 ,
            1.037792e-2 ,
            9.529306e-3 ,
            8.749999e-3 ,
            8.035200e-3 ,
            7.381600e-3 ,
            6.785400e-3 ,
            6.242800e-3 ,
            5.749999e-3 ,
            5.303600e-3 ,
            4.899800e-3 ,
            4.534200e-3 ,
            4.202400e-3 ,
            3.900000e-3 ,
            3.623200e-3 ,
            3.370600e-3 ,
            3.141400e-3 ,
            2.934800e-3 ,
            2.749999e-3 ,
            2.585200e-3 ,
            2.438600e-3 ,
            2.309400e-3 ,
            2.196800e-3 ,
            2.100000e-3 ,
            2.017733e-3 ,
            1.948200e-3 ,
            1.889800e-3 ,
            1.840933e-3 ,
            1.800000e-3 ,
            1.766267e-3 ,
            1.737800e-3 ,
            1.711200e-3 ,
            1.683067e-3 ,
            1.650001e-3 ,
            1.610133e-3 ,
            1.564400e-3 ,
            1.513600e-3 ,
            1.458533e-3 ,
            1.400000e-3 ,
            1.336667e-3 ,
            1.270000e-3 ,
            1.205000e-3 ,
            1.146667e-3 ,
            1.100000e-3 ,
            1.068800e-3 ,
            1.049400e-3 ,
            1.035600e-3 ,
            1.021200e-3 ,
            1.000000e-3 ,
            9.686400e-4 ,
            9.299200e-4 ,
            8.868800e-4 ,
            8.425600e-4 ,
            8.000000e-4 ,
            7.609600e-4 ,
            7.236800e-4 ,
            6.859200e-4 ,
            6.454400e-4 ,
            6.000000e-4 ,
            5.478667e-4 ,
            4.916000e-4 ,
            4.354000e-4 ,
            3.834667e-4 ,
            3.400000e-4 ,
            3.072533e-4 ,
            2.831600e-4 ,
            2.654400e-4 ,
            2.518133e-4 ,
            2.400000e-4 ,
            2.295467e-4 ,
            2.206400e-4 ,
            2.119600e-4 ,
            2.021867e-4 ,
            1.900000e-4 ,
            1.742133e-4 ,
            1.556400e-4 ,
            1.359600e-4 ,
            1.168533e-4 ,
            1.000000e-4 ,
            8.613333e-5 ,
            7.460000e-5 ,
            6.500000e-5 ,
            5.693333e-5 ,
            4.999999e-5 ,
            4.416000e-5 ,
            3.948000e-5 ,
            3.572000e-5 ,
            3.264000e-5 ,
            3.000000e-5 ,
            2.765333e-5 ,
            2.556000e-5 ,
            2.364000e-5 ,
            2.181333e-5 ,
            2.000000e-5 ,
            1.813333e-5 ,
            1.620000e-5 ,
            1.420000e-5 ,
            1.213333e-5 ,
            1.000000e-5 ,
            7.733333e-6 ,
            5.400000e-6 ,
            3.200000e-6 ,
            1.333333e-6 ,
            0.0
        };

        private static readonly double[] cieVs = new double[]
        {
            5.890e-4 ,
            6.650e-4 ,
            7.520e-4 ,
            8.540e-4 ,
            9.720e-4 ,
            1.108e-3 ,
            1.268e-3 ,
            1.453e-3 ,
            1.668e-3 ,
            1.918e-3 ,
            2.209e-3 ,
            2.547e-3 ,
            2.939e-3 ,
            3.394e-3 ,
            3.921e-3 ,
            4.530e-3 ,
            5.240e-3 ,
            6.050e-3 ,
            6.980e-3 ,
            8.060e-3 ,
            9.290e-3 ,
            1.070e-2 ,
            1.231e-2 ,
            1.413e-2 ,
            1.619e-2 ,
            1.852e-2 ,
            2.113e-2 ,
            2.405e-2 ,
            2.730e-2 ,
            3.089e-2 ,
            3.484e-2 ,
            3.916e-2 ,
            4.390e-2 ,
            4.900e-2 ,
            5.450e-2 ,
            6.040e-2 ,
            6.680e-2 ,
            7.360e-2 ,
            8.080e-2 ,
            8.850e-2 ,
            9.660e-2 ,
            1.052e-1 ,
            1.141e-1 ,
            1.235e-1 ,
            1.334e-1 ,
            1.436e-1 ,
            1.541e-1 ,
            1.651e-1 ,
            1.764e-1 ,
            1.879e-1 ,
            1.998e-1 ,
            2.119e-1 ,
            2.243e-1 ,
            2.369e-1 ,
            2.496e-1 ,
            2.625e-1 ,
            2.755e-1 ,
            2.886e-1 ,
            3.017e-1 ,
            3.149e-1 ,
            3.281e-1 ,
            3.412e-1 ,
            3.543e-1 ,
            3.673e-1 ,
            3.803e-1 ,
            3.931e-1 ,
            4.060e-1 ,
            4.180e-1 ,
            4.310e-1 ,
            4.430e-1 ,
            4.550e-1 ,
            4.670e-1 ,
            4.790e-1 ,
            4.900e-1 ,
            5.020e-1 ,
            5.130e-1 ,
            5.240e-1 ,
            5.350e-1 ,
            5.460e-1 ,
            5.570e-1 ,
            5.670e-1 ,
            5.780e-1 ,
            5.880e-1 ,
            5.990e-1 ,
            6.100e-1 ,
            6.200e-1 ,
            6.310e-1 ,
            6.420e-1 ,
            6.530e-1 ,
            6.640e-1 ,
            6.760e-1 ,
            6.870e-1 ,
            6.990e-1 ,
            7.100e-1 ,
            7.220e-1 ,
            7.340e-1 ,
            7.450e-1 ,
            7.570e-1 ,
            7.690e-1 ,
            7.810e-1 ,
            7.930e-1 ,
            8.050e-1 ,
            8.170e-1 ,
            8.280e-1 ,
            8.400e-1 ,
            8.510e-1 ,
            8.620e-1 ,
            8.730e-1 ,
            8.840e-1 ,
            8.940e-1 ,
            9.040e-1 ,
            9.140e-1 ,
            9.230e-1 ,
            9.320e-1 ,
            9.410e-1 ,
            9.490e-1 ,
            9.570e-1 ,
            9.640e-1 ,
            9.700e-1 ,
            9.760e-1 ,
            9.820e-1 ,
            9.860e-1 ,
            9.900e-1 ,
            9.940e-1 ,
            9.970e-1 ,
            9.980e-1 ,
            1.000e+0 ,
            1.000e+0 ,
            1.000e+0 ,
            9.980e-1 ,
            9.970e-1 ,
            9.940e-1 ,
            9.900e-1 ,
            9.860e-1 ,
            9.810e-1 ,
            9.750e-1 ,
            9.680e-1 ,
            9.610e-1 ,
            9.530e-1 ,
            9.440e-1 ,
            9.350e-1 ,
            9.250e-1 ,
            9.150e-1 ,
            9.040e-1 ,
            8.920e-1 ,
            8.800e-1 ,
            8.670e-1 ,
            8.540e-1 ,
            8.400e-1 ,
            8.260e-1 ,
            8.110e-1 ,
            7.960e-1 ,
            7.810e-1 ,
            7.650e-1 ,
            7.490e-1 ,
            7.330e-1 ,
            7.170e-1 ,
            7.000e-1 ,
            6.830e-1 ,
            6.670e-1 ,
            6.500e-1 ,
            6.330e-1 ,
            6.160e-1 ,
            5.990e-1 ,
            5.810e-1 ,
            5.640e-1 ,
            5.480e-1 ,
            5.310e-1 ,
            5.140e-1 ,
            4.970e-1 ,
            4.810e-1 ,
            4.650e-1 ,
            4.480e-1 ,
            4.330e-1 ,
            4.170e-1 ,
            4.020e-1 ,
            3.864e-1 ,
            3.715e-1 ,
            3.569e-1 ,
            3.427e-1 ,
            3.288e-1 ,
            3.151e-1 ,
            3.018e-1 ,
            2.888e-1 ,
            2.762e-1 ,
            2.639e-1 ,
            2.519e-1 ,
            2.403e-1 ,
            2.291e-1 ,
            2.182e-1 ,
            2.076e-1 ,
            1.974e-1 ,
            1.876e-1 ,
            1.782e-1 ,
            1.690e-1 ,
            1.602e-1 ,
            1.517e-1 ,
            1.436e-1 ,
            1.358e-1 ,
            1.284e-1 ,
            1.212e-1 ,
            1.143e-1 ,
            1.078e-1 ,
            1.015e-1 ,
            9.560e-2 ,
            8.990e-2 ,
            8.450e-2 ,
            7.930e-2 ,
            7.450e-2 ,
            6.990e-2 ,
            6.550e-2 ,
            6.130e-2 ,
            5.740e-2 ,
            5.370e-2 ,
            5.020e-2 ,
            4.690e-2 ,
            4.380e-2 ,
            4.090e-2 ,
            3.816e-2 ,
            3.558e-2 ,
            3.315e-2 ,
            3.087e-2 ,
            2.874e-2 ,
            2.674e-2 ,
            2.487e-2 ,
            2.312e-2 ,
            2.147e-2 ,
            1.994e-2 ,
            1.851e-2 ,
            1.718e-2 ,
            1.593e-2 ,
            1.477e-2 ,
            1.369e-2 ,
            1.269e-2 ,
            1.175e-2 ,
            1.088e-2 ,
            1.007e-2 ,
            9.320e-3 ,
            8.620e-3 ,
            7.970e-3 ,
            7.370e-3 ,
            6.820e-3 ,
            6.300e-3 ,
            5.820e-3 ,
            5.380e-3 ,
            4.970e-3 ,
            4.590e-3 ,
            4.240e-3 ,
            3.913e-3 ,
            3.613e-3 ,
            3.335e-3 ,
            3.079e-3 ,
            2.842e-3 ,
            2.623e-3 ,
            2.421e-3 ,
            2.235e-3 ,
            2.062e-3 ,
            1.903e-3 ,
            1.757e-3 ,
            1.621e-3 ,
            1.497e-3 ,
            1.382e-3 ,
            1.276e-3 ,
            1.178e-3 ,
            1.088e-3 ,
            1.005e-3 ,
            9.280e-4 ,
            8.570e-4 ,
            7.920e-4 ,
            7.320e-4 ,
            6.770e-4 ,
            6.260e-4 ,
            5.790e-4 ,
            5.360e-4 ,
            4.960e-4 ,
            4.590e-4 ,
            4.250e-4 ,
            3.935e-4 ,
            3.645e-4 ,
            3.377e-4 ,
            3.129e-4 ,
            2.901e-4 ,
            2.689e-4 ,
            2.493e-4 ,
            2.313e-4 ,
            2.146e-4 ,
            1.991e-4 ,
            1.848e-4 ,
            1.716e-4 ,
            1.593e-4 ,
            1.480e-4 ,
            1.375e-4 ,
            1.277e-4 ,
            1.187e-4 ,
            1.104e-4 ,
            1.026e-4 ,
            9.540e-5 ,
            8.880e-5 ,
            8.260e-5 ,
            7.690e-5 ,
            7.150e-5 ,
            6.660e-5 ,
            6.200e-5 ,
            5.780e-5 ,
            5.380e-5 ,
            5.010e-5 ,
            4.670e-5 ,
            4.360e-5 ,
            4.060e-5 ,
            3.789e-5 ,
            3.533e-5 ,
            3.295e-5 ,
            3.075e-5 ,
            2.870e-5 ,
            2.679e-5 ,
            2.501e-5 ,
            2.336e-5 ,
            2.182e-5 ,
            2.038e-5 ,
            1.905e-5 ,
            1.780e-5 ,
            1.664e-5 ,
            1.556e-5 ,
            1.454e-5 ,
            1.360e-5 ,
            1.273e-5 ,
            1.191e-5 ,
            1.114e-5 ,
            1.043e-5 ,
            9.760e-6 ,
            9.140e-6 ,
            8.560e-6 ,
            8.020e-6 ,
            7.510e-6 ,
            7.040e-6 ,
            6.600e-6 ,
            6.180e-6 ,
            5.800e-6 ,
            5.440e-6 ,
            5.100e-6 ,
            4.780e-6 ,
            4.490e-6 ,
            4.210e-6 ,
            3.951e-6 ,
            3.709e-6 ,
            3.482e-6 ,
            3.270e-6 ,
            3.070e-6 ,
            2.884e-6 ,
            2.710e-6 ,
            2.546e-6 ,
            2.393e-6 ,
            2.250e-6 ,
            2.115e-6 ,
            1.989e-6 ,
            1.870e-6 ,
            1.759e-6 ,
            1.655e-6 ,
            1.557e-6 ,
            1.466e-6 ,
            1.379e-6 ,
            1.299e-6 ,
            1.223e-6 ,
            1.151e-6 ,
            1.084e-6 ,
            1.022e-6 ,
            9.620e-7 ,
            9.070e-7 ,
            8.550e-7 ,
            8.060e-7 ,
            7.600e-7 ,
            7.160e-7 ,
            6.750e-7 ,
            6.370e-7 ,
            6.010e-7 ,
            5.670e-7 ,
            5.350e-7 ,
            5.050e-7 ,
            4.770e-7 ,
            4.500e-7 ,
            4.250e-7 ,
            4.010e-7 ,
            3.790e-7 ,
            3.580e-7 ,
            3.382e-7 ,
            3.196e-7 ,
            3.021e-7 ,
            2.855e-7 ,
            2.699e-7 ,
            2.552e-7 ,
            2.413e-7 ,
            2.282e-7 ,
            2.159e-7 ,
            2.042e-7 ,
            1.932e-7 ,
            1.829e-7 ,
            1.731e-7 ,
            1.638e-7 ,
            1.551e-7 ,
            1.468e-7 ,
            1.390e-7
        };

        private static double ConvertArrayToFunction(int lambda, double[] array, int offset)
        {
            int index = lambda - offset;
            if (index < 0)
                return 0.0;
            if (index >= array.Length)
                return 0.0;
            return array[index];
        }
        #endregion
    }
}
